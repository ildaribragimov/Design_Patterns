"use strict";

/**
 * Объект "Всплывающее окно"
 *
 * @constructor
 * @this {Ajax}
 * @param {object} settings - Объект параметров запроса XMLHttpRequest
 * @param {string} settings.url - Адрес запроса
 * @param {string} settings.data - Данные, отправляемые на сервер. Могут быть переданы только как URI-строка или javascript-объекта
 * @param {string} settings.method - Метод отправки запроса
 * @param {boolean} settings.async - Тип запроса. "true" - асинхронный, "false" - синхронный
 * @param {function} settings.error - Функция, которая будет вызвана в случае неудачного завершения запроса к серверу
 * @param {function} settings.success - Функция, которая будет вызвана в случае удачного завершения запроса к серверу
 */
function ajax(a){function e(a){var b="",d;for(d in a)a.hasOwnProperty(d)&&(b=b+d+"="+encodeURIComponent(a[d])+"&");return b.substring(0,b.length-1)}a.data=a.data||null;a.method=a.method||"get";a.async=a.async||"true";a.error=a.error||null;a.success=a.success||null;var c=null;if(a.data)switch("object"===typeof a.data&&(a.data=e(a.data)),a.method){case "get":a.url=a.url+"?"+a.data;break;case "post":c=a.data}var b=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");b.onreadystatechange=function(){if(4===b.readyState){var c=b.responseText;200===b.status?a.success&&a.success(c):a.error&&a.error(b.status+": "+b.statusText)}};b.open(a.method,a.url,a.async);"post"===a.method&&b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");b.send(c)};